# .github/dependabot.yml
# Dependabot configuration for MoneyWise monorepo
# Manages dependencies across npm/pnpm, Docker, and GitHub Actions

version: 2
  updates:
    # Root workspace dependencies (pnpm monorepo)
    - package-ecosystem: "npm"
      directory: "/"
      schedule:
        interval: "weekly"
        day: "monday"
        time: "03:00"
      open-pull-requests-limit: 10
      groups:
        # Group Sentry packages together
        sentry:
          patterns:
            - "@sentry/*"
        # Group development dependencies
        dev-dependencies:
          dependency-type: "development"
          update-types:
            - "minor"
            - "patch"
        # Group production dependencies (patch only)
        production-dependencies:
          dependency-type: "production"
          update-types:
            - "patch"
      labels:
        - "dependencies"
        - "automated"
      commit-message:
        prefix: "chore(deps)"
        include: "scope"

    # Backend app dependencies
    - package-ecosystem: "npm"
      directory: "/apps/backend"
      schedule:
        interval: "weekly"
        day: "monday"
        time: "03:00"
      open-pull-requests-limit: 5
      groups:
        nestjs:
          patterns:
            - "@nestjs/*"
        typeorm:
          patterns:
            - "typeorm"
            - "@types/typeorm"
      labels:
        - "dependencies"
        - "backend"
        - "automated"
      commit-message:
        prefix: "chore(deps)"
        prefix-development: "chore(deps-dev)"
        include: "scope"

    # Web app dependencies
    - package-ecosystem: "npm"
      directory: "/apps/web"
      schedule:
        interval: "weekly"
        day: "monday"
        time: "03:00"
      open-pull-requests-limit: 5
      groups:
        nextjs:
          patterns:
            - "next"
            - "@next/*"
        react:
          patterns:
            - "react"
            - "react-dom"
            - "@types/react"
            - "@types/react-dom"
      labels:
        - "dependencies"
        - "frontend"
        - "automated"
      commit-message:
        prefix: "chore(deps)"
        prefix-development: "chore(deps-dev)"
        include: "scope"

    # Mobile app dependencies
    - package-ecosystem: "npm"
      directory: "/apps/mobile"
      schedule:
        interval: "weekly"
        day: "monday"
        time: "03:00"
      open-pull-requests-limit: 5
      groups:
        react-native:
          patterns:
            - "react-native"
            - "expo"
            - "expo-*"
        react:
          patterns:
            - "react"
            - "react-dom"
            - "@types/react"
            - "@types/react-dom"
      labels:
        - "dependencies"
        - "mobile"
        - "automated"
      commit-message:
        prefix: "chore(deps)"
        prefix-development: "chore(deps-dev)"
        include: "scope"

    # Backend Dockerfile
    - package-ecosystem: "docker"
      directory: "/apps/backend"
      schedule:
        interval: "weekly"
        day: "tuesday"
        time: "03:00"
      open-pull-requests-limit: 3
      labels:
        - "dependencies"
        - "docker"
        - "backend"
        - "automated"
      commit-message:
        prefix: "chore(docker)"
        include: "scope"

    # Web Dockerfile
    - package-ecosystem: "docker"
      directory: "/apps/web"
      schedule:
        interval: "weekly"
        day: "tuesday"
        time: "03:00"
      open-pull-requests-limit: 3
      labels:
        - "dependencies"
        - "docker"
        - "frontend"
        - "automated"
      commit-message:
        prefix: "chore(docker)"
        include: "scope"

    # GitHub Actions workflows
    - package-ecosystem: "github-actions"
      directory: "/"
      schedule:
        interval: "weekly"
        day: "wednesday"
        time: "03:00"
      open-pull-requests-limit: 5
      labels:
        - "dependencies"
        - "github-actions"
        - "ci-cd"
        - "automated"
      commit-message:
        prefix: "chore(ci)"
        include: "scope"
