
> @money-wise/backend@0.1.0 test:unit /home/nemesi/dev/money-wise/apps/backend
> jest --passWithNoTests --testPathPattern='src'

PASS @money-wise/backend src/common/decorators/__tests__/sentry-transaction.decorator.spec.ts
  SentryTransactionDecorator
    withSentryTransaction
      ✓ should wrap function with Sentry transaction (5 ms)
      ✓ should handle errors in wrapped function (7 ms)
    SentryTransactionManager
      ✓ should manage transaction lifecycle (2 ms)

PASS @money-wise/backend src/common/interceptors/__tests__/sentry.interceptor.spec.ts
  SentryInterceptor
    intercept
      ✓ should create interceptor instance (2 ms)

PASS @money-wise/backend src/auth/auth.service.spec.ts
  AuthService
    register
      ✓ should register a new user successfully (19 ms)
      ✓ should throw ConflictException if user already exists (12 ms)
    login
      ✓ should login user successfully (4 ms)
      ✓ should throw UnauthorizedException if user not found (4 ms)
      ✓ should throw UnauthorizedException if password is invalid (3 ms)
      ✓ should throw UnauthorizedException if user is not active (8 ms)
    validateUser
      ✓ should return user if valid (3 ms)
      ✓ should throw UnauthorizedException if user not found (3 ms)
      ✓ should throw UnauthorizedException if user is not active (3 ms)

PASS @money-wise/backend src/core/database/repositories/__tests__/base.repository.spec.ts
  BaseRepository
    constructor
      ✓ should initialize repository with correct entity (7 ms)
    create
      ✓ should create and save a new entity successfully (4 ms)
      ✓ should handle creation errors and throw descriptive error (16 ms)
    save
      ✓ should save an existing entity successfully (3 ms)
      ✓ should handle save errors (2 ms)
    findById
      ✓ should find entity by ID successfully (2 ms)
      ✓ should return null when entity not found (10 ms)
      ✓ should handle findById errors (3 ms)
    findOne
      ✓ should find one entity with FindOptionsWhere (3 ms)
      ✓ should find one entity with FindOneOptions (3 ms)
      ✓ should handle findOne errors (2 ms)
    find
      ✓ should find multiple entities with options (3 ms)
      ✓ should find all entities when no options provided (2 ms)
      ✓ should handle find errors (3 ms)
    findWithPagination
      ✓ should return paginated results (2 ms)
      ✓ should handle pagination with criteria (2 ms)
      ✓ should handle pagination errors (3 ms)
    update
      ✓ should update entity successfully (2 ms)
      ✓ should return null when entity to update not found (7 ms)
      ✓ should handle update errors (3 ms)
    delete
      ✓ should delete entity successfully (4 ms)
      ✓ should return false when no entity was deleted (2 ms)
      ✓ should handle delete errors (2 ms)
    deleteBy
      ✓ should delete entities by criteria (3 ms)
      ✓ should handle deleteBy errors (3 ms)
    count
      ✓ should count entities with criteria (2 ms)
      ✓ should count all entities when no criteria provided (2 ms)
      ✓ should handle count errors (2 ms)
    exists
      ✓ should return true when entity exists (2 ms)
      ✓ should return false when entity does not exist (1 ms)
      ✓ should handle exists errors (11 ms)
    bulkInsert
      ✓ should perform bulk insert successfully (2 ms)
      ✓ should handle bulk insert errors (2 ms)
    bulkUpdate
      ✓ should perform bulk update successfully (2 ms)
      ✓ should handle bulk update errors (2 ms)
    query
      ✓ should execute raw query successfully (3 ms)
      ✓ should execute parameterized query (2 ms)
      ✓ should handle query errors (2 ms)

PASS @money-wise/backend src/core/health/health.controller.spec.ts
  HealthController
    ✓ should be defined (4 ms)
    getHealth
      ✓ should return basic health status (3 ms)
      ✓ should return consistent timestamp format (3 ms)
      ✓ should return positive uptime (2 ms)
      ✓ should return memory usage (3 ms)
    getDetailedHealth
      ✓ should return detailed health with services status (13 ms)
      ✓ should include database response time (4 ms)
    getReadiness
      ✓ should return readiness status (2 ms)
    getLiveness
      ✓ should return liveness status (2 ms)

PASS @money-wise/backend src/core/database/repositories/__tests__/integration/repositories.integration.spec.ts
  Repository Integration Tests
    Repository Pattern Integration
      ✓ should have repositories properly exported from index (205 ms)
      ✓ should have repository module and injection tokens exported (1 ms)
      ✓ should validate repository structure integrity (1 ms)
      ✓ should validate test coverage completeness (1 ms)
    Repository Pattern Compliance
      ✓ should document zero-tolerance validation achievements (1 ms)
      ✓ should validate atomic commit compliance (1 ms)

PASS @money-wise/backend src/core/database/repositories/__tests__/user.repository.spec.ts
  UserRepository
    findByEmail
      ✓ should find user by email with case insensitivity (12 ms)
      ✓ should return null when user not found (2 ms)
      ✓ should handle findByEmail errors (16 ms)
    isEmailTaken
      ✓ should return true when email is taken (3 ms)
      ✓ should return false when email is not taken (2 ms)
      ✓ should exclude specific user when checking email availability (2 ms)
      ✓ should handle isEmailTaken errors (3 ms)
    findByEmailVerificationToken
      ✓ should return null for email verification token (not implemented) (2 ms)
      ✓ should handle findByEmailVerificationToken errors (8 ms)
    findByPasswordResetToken
      ✓ should return null for password reset token (not implemented) (2 ms)
      ✓ should handle findByPasswordResetToken errors (4 ms)
    markEmailAsVerified
      ✓ should mark email as verified successfully (3 ms)
      ✓ should return false when no user was updated (2 ms)
      ✓ should handle markEmailAsVerified errors (2 ms)
    updatePasswordHash
      ✓ should update password hash successfully (3 ms)
      ✓ should return false when no user was updated (2 ms)
      ✓ should handle updatePasswordHash errors (3 ms)
    setPasswordResetToken
      ✓ should return false for password reset token (not implemented) (2 ms)
      ✓ should handle setPasswordResetToken errors (2 ms)
    clearPasswordResetToken
      ✓ should return false for clear password reset token (not implemented) (2 ms)
      ✓ should handle clearPasswordResetToken errors (2 ms)
    findWithAccounts
      ✓ should find user with their accounts (2 ms)
      ✓ should return null when user not found (3 ms)
      ✓ should handle findWithAccounts errors (2 ms)
    findByDateRange
      ✓ should find users within date range (3 ms)
      ✓ should handle findByDateRange errors (2 ms)
    getUserStats
      ✓ should return user statistics (3 ms)
      ✓ should handle getUserStats errors (2 ms)
    softDelete
      ✓ should log soft delete request (4 ms)
      ✓ should handle softDelete errors (4 ms)
    search
      ✓ should search users by first name, last name, and email (4 ms)
      ✓ should use default limit when not provided (3 ms)
      ✓ should handle search errors (3 ms)

PASS @money-wise/backend src/core/database/repositories/__tests__/account.repository.spec.ts
  AccountRepository
    findByUserId
      ✓ should find accounts by user ID (5 ms)
      ✓ should handle findByUserId errors (17 ms)
    findActiveAccountsByUserId
      ✓ should find active accounts by user ID (9 ms)
      ✓ should handle findActiveAccountsByUserId errors (2 ms)
    updateBalance
      ✓ should update account currentBalance successfully (3 ms)
      ✓ should return false when no account was updated (2 ms)
      ✓ should handle updateBalance errors (2 ms)
    incrementBalance
      ✓ should increment account currentBalance successfully (2 ms)
      ✓ should return false when no account was updated (1 ms)
      ✓ should handle incrementBalance errors (3 ms)
    decrementBalance
      ✓ should decrement account currentBalance successfully (3 ms)
      ✓ should handle decrementBalance errors (2 ms)
    getTotalBalanceForUser
      ✓ should get total currentBalance for user (8 ms)
      ✓ should return 0 when no total found (2 ms)
      ✓ should handle getTotalBalanceForUser errors (2 ms)
    findByPlaidAccountId
      ✓ should find account by Plaid account ID (2 ms)
      ✓ should return null when Plaid account not found (2 ms)
      ✓ should handle findByPlaidAccountId errors (1 ms)
    deactivateAccount
      ✓ should deactivate account successfully (1 ms)
      ✓ should return false when no account was deactivated (2 ms)
      ✓ should handle deactivateAccount errors (2 ms)
    reactivateAccount
      ✓ should reactivate account successfully (2 ms)
      ✓ should handle reactivateAccount errors (2 ms)
    findAccountsForSync
      ✓ should find accounts for sync with user filter (2 ms)
      ✓ should find all accounts for sync without user filter (3 ms)
      ✓ should handle findAccountsForSync errors (9 ms)
    getAccountBalancesSummary
      ✓ should get account currentBalances summary by type (4 ms)
      ✓ should handle getAccountBalancesSummary errors (2 ms)
    findLowBalanceAccounts
      ✓ should find low currentBalance accounts with user filter (3 ms)
      ✓ should handle findLowBalanceAccounts errors (5 ms)

Test Suites: 8 passed, 8 total
Tests:       129 passed, 129 total
Snapshots:   0 total
Time:        8.212 s
Ran all test suites matching /src/i.
